<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GSAP Infinite Gallery — Drag From Anywhere Fixed</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<style>
  *{margin:0;padding:0;box-sizing:border-box;}
  :root{--bg-color: #ffffff;}
  html,body{width:100%;height:100%;overflow:hidden;background:var(--bg-color);user-select:none;}
  .wrapper{position:absolute;width:300vw;height:300vh;top:0;left:0;cursor:grab;will-change:transform;}
  .wrapper.dragging{cursor:grabbing;}
  .gallery{position:absolute;width:100vw;height:100vh;top:0;left:0;}
  .gallery a{position:absolute;display:block;pointer-events:auto;overflow: hidden;transition: transform 0.25s ease;transform:scale(1);}
  .gallery img{position:relative;display:block;width:100%;height:auto;object-fit:cover;border:none;border-radius:0;pointer-events:none;-webkit-user-drag:none;transform:scale(0);transition: transform 1s ease;transition-delay: 0.5s}
  .gallery a:hover{transform:scale(1.1);}
  .gallery a:hover img{transform:scale(1);}

  .page-loaded .gallery img{transform:scale(1.15);}

  .text-wrapper{position:relative;width:100vw;height:100vh;}
  .center-text-wrap{height: 0;transition: height 0.5s ease;overflow: hidden;position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);}
  .page-loaded .center-text-wrap{height: 280px;}
  .center-text{font-size:10vw;color:#000000;font-weight:700;font-family:sans-serif;display:block;white-space:nowrap;text-align:center;}

  /* === Individual Image Positions & Sizes === */
  .img1{left:74.5955vw;top:17.3469vh;width:193px;}
  .img2{left:75.1554vw;top:54.2422vh;width:394px;}
  .img3{left:3.38786vw;top:16.7045vh;width:248px;}
  .img4{left:36.0319vw;top:33.9018vh;width:507px;}
  .img5{left:3.10872vw;top:84.3504vh;width:347px;}
  .img6{left:56.3314vw;top:9.12198vh;width:248px;}
  .img7{left:10.0804vw;top:55.2704vh;width:257px;}
  .img8{left:86vw;top:0vh;width:358px;}
  .img9{left:55.3719vw;top:79.5232vh;width:224px;}
  .img10{left:27.2629vw;top:-8vh;width:370px;}
</style>
</head>
<body>

<div class="gallery" id="gallery-template">
  <a href="#" class="img1"><img src="https://picsum.photos/id/1015/400/250" alt=""></a>
  <a href="#" class="img2"><img src="https://picsum.photos/id/1016/400/250" alt=""></a>
  <a href="#" class="img3"><img src="https://picsum.photos/id/1018/400/250" alt=""></a>
  <a href="#" class="img4"><img src="https://picsum.photos/id/1025/400/250" alt=""></a>
  <a href="#" class="img5"><img src="https://picsum.photos/id/1035/400/250" alt=""></a>
  <a href="#" class="img6"><img src="https://picsum.photos/id/1043/400/250" alt=""></a>
  <a href="#" class="img7"><img src="https://picsum.photos/id/1050/400/250" alt=""></a>
  <a href="#" class="img8"><img src="https://picsum.photos/id/1069/400/250" alt=""></a>
  <a href="#" class="img9"><img src="https://picsum.photos/id/1074/400/250" alt=""></a>
  <a href="#" class="img10"><img src="https://picsum.photos/id/1084/400/250" alt=""></a>
</div>
<div class="text-wrapper">
  <div class="center-text-wrap">
    <span class="center-text">Image Gallery</span>
  </div>
  <div class="wrapper" id="wrapper"></div>
  
</div>

<script>

window.onload = function() {
  document.body.classList.add('page-loaded');
};



// === CLONE GRID 3x3 FOR INFINITE WRAP ===
const wrapper = document.getElementById("wrapper");
const template = document.getElementById("gallery-template");

for(let y=-1;y<=1;y++){
  for(let x=-1;x<=1;x++){
    const clone = template.cloneNode(true);
    clone.style.left = `${x*100}vw`;
    clone.style.top = `${y*100}vh`;
    wrapper.appendChild(clone);
  }
}
template.remove();

// === VARIABLES ===
let vw = window.innerWidth, vh = window.innerHeight;
let virtualPos = {x:-vw, y:-vh};
let isDown=false, start={x:0,y:0}, startPos={x:0,y:0};
let vel={x:0,y:0}, lastPos={x:0,y:0}, lastTime=Date.now();
let dragMoved = false;

// === WRAP FUNCTION ===
function getWrappedPos(vx,vy){
  let x = ((vx % vw) + vw) % vw - vw;
  let y = ((vy % vh) + vh) % vh - vh;
  return {x, y};
}

// === APPLY INSTANT WRAP ===
function apply(){
  const {x,y}=getWrappedPos(virtualPos.x,virtualPos.y);
  gsap.set(wrapper,{x,y});
}
function loop(){apply();requestAnimationFrame(loop);} loop();

// === EVENTS ===
window.addEventListener("pointerdown",e=>{
  isDown=true; dragMoved=false;
  start.x=e.clientX; start.y=e.clientY;
  startPos.x=virtualPos.x; startPos.y=virtualPos.y;
  lastPos.x=e.clientX; lastPos.y=e.clientY;
  lastTime=Date.now(); vel.x=vel.y=0;
  wrapper.classList.add('dragging');
  gsap.killTweensOf(virtualPos);
  e.preventDefault(); 
  wrapper.setPointerCapture(e.pointerId);
});

window.addEventListener("pointermove",e=>{
  if(isDown){
    const dx=e.clientX-start.x, dy=e.clientY-start.y;
    if(Math.abs(dx)>5 || Math.abs(dy)>5) dragMoved=true;
    const now=Date.now(), dt=Math.max(now-lastTime,1);
    vel.x=(e.clientX-lastPos.x)/dt*16;
    vel.y=(e.clientY-lastPos.y)/dt*16;
    virtualPos.x=startPos.x+dx;
    virtualPos.y=startPos.y+dy;
    lastPos.x=e.clientX; lastPos.y=e.clientY; lastTime=now;
  }
});

window.addEventListener("pointerup", e => {
  if (!isDown) return;
  isDown = false;
  wrapper.classList.remove('dragging');
  wrapper.releasePointerCapture(e.pointerId);

  // prevent small velocity drift
  const speed = Math.sqrt(vel.x ** 2 + vel.y ** 2);
  if (speed < 0.5) return;

  if (dragMoved) {
    e.preventDefault();
    gsap.to(virtualPos, {
      x: virtualPos.x + vel.x * 6,
      y: virtualPos.y + vel.y * 6,
      duration: 1,
      ease: "cubic-bezier(.93,-0.05,.2,1.04)"
    });
  }
});


// === SCROLL SUPPORT ===
window.addEventListener("wheel", e => {
  // instead of moving separately on x and y,
  // create diagonal motion from top-right → bottom-left
  const scrollStrength = 4; // adjust for speed

  // scroll down = move bottom-left, scroll up = top-right
  gsap.to(virtualPos, {
    x: virtualPos.x - e.deltaY * scrollStrength,  // ← horizontal shift
    y: virtualPos.y + e.deltaY * scrollStrength,  // ↓ vertical shift
    duration: 1,
    ease: "cubic-bezier(.93,-0.05,.2,1.04)"
  });
});


window.addEventListener("resize",()=>{
  vw=window.innerWidth; vh=window.innerHeight;
});
</script>
</body>
</html>
